<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script
      src="https://kit.fontawesome.com/64d58efce2.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="style.css" />
    <title>Servidor</title>
  </head>
  <body>
    <div class="container">
      <div class="forms-container">
        <div class="signin-signup">
          <form action="#" class="sign-in-form">
            <h2 class="title">Sign in</h2>
            <div class="input-field">
              <i class="fas fa-user"></i>
              <input type="text" placeholder="Username" id="usern" />
            </div>
            <div class="input-field">
              <i class="fas fa-lock"></i>
              <input type="password" placeholder="Password" id="contra" />
            </div>
            <input type="submit" value="Login" class="btn solid" onclick="login()"/>
            
            
          </form>
          <form id="formDregistro" action="#" class="sign-up-form">
            <h2 class="title">Sign up</h2>
            <div class="input-field">
      <i class="fas fa-user"></i>
      <input type="text" placeholder="User" class="input"  id="user" name="user">
      
    </div>
      
      <div class="input-field">
     <i class="fas fa-lock"></i> 
     <input type="password" placeholder="Password" class="input"  id="passw" name="passw">
      
    </div>
   
    <div class="input-field"> 
    <i class="fas fa-user"></i>
    
      <input type="text" placeholder="Name" class="input"  id="name" name="name">
     
    </div>
    
     <div class="input-field">
      <i class="fas fa-user"></i> 
      <input type="text" placeholder="LastName" class="input"  id="lastname" name="lastname">
     
    </div>
   
    <div class="input-field">
     <i class="far fa-envelope"></i> 
     <input type="text" placeholder="Email" class="input"  id="email" name="email">
      
    </div>
    
    <div class="input-field">
     <i class="fas fa-phone"></i> 
     <input type="number" placeholder="cellphone" class="input"  id="cell" name="cell"> 
      
    </div>

  <div class="input-field">
      <i class="fas fa-id-card"></i>
      <input type="number" placeholder="ID" class="input"  id="ced" name="ced">
      
    </div>
  
    <div class="input-field">
     <i class="fas fa-sort-numeric-up-alt"></i> 
     <input type="text" placeholder="Age" class="input"  id="age" name="age">
      
    </div>
    
    <div  id="boton" >
      <input type="button" value="Sign up" class="btn" onclick="checkEmail(); checkPassword(); registrar()">
    </div>
           
         
          </form>
        </div>
      </div>

      <div class="panels-container">
        <div class="panel left-panel">
          <div class="content">
            <h3>New here ?</h3>
            <p>
              Lorem ipsum, dolor sit amet consectetur adipisicing elit. Debitis,
              ex ratione. Aliquid!
            </p>
            <button class="btn transparent" id="sign-up-btn">
              Sign up
            </button>
          </div>
         
        </div>
        <div class="panel right-panel">
          <div class="content">
            <h3>One of us ?</h3>
            <p>
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Nostrum
              laboriosam ad deleniti.
            </p>
            <button class="btn transparent" id="sign-in-btn">
              Sign in
            </button>
          </div>
                 </div>
      </div>
    </div>

    <script src="app.js"></script>
    <script>
    var a = 0;
    var b = 0;
    
    function login(){
    	if(a == 0 && b == 0){
        var json ={
                us: document.getElementById("usern").value,
                contrasena: document.getElementById("contra").value,
                us: document.getElementById("usern").value,
                contrasena: document.getElementById("contra").value
        }
        
        
        let configs = {
                method: 'post',
                body: JSON.stringify(json),
                withCredentials: true,
                credentials: 'include',
                headers: {
                    'Content-type': 'application/json'
                }
        
        } 
        console.log(configs.body);
	    fetch('./log', configs)
        .then(res => res.json())
        .then(data => {
        	console.log(data)
        	let userData = data.userData;
            if(data.status == 200){
            	alert("todo bien registro con exito");
            	document.location.replace(`http://localhost:9092/Servidor/home.html`)
            }
            	else{
            		console.log("jaja kloko no");
            	}
            	
    });
        
    }
    }
    function registrar(){

    	if(a == 1 && b == 1){
    	    var json ={
    	    		us: document.getElementById("user").value,
    	    		telf:document.getElementById("cell").value,
    	    		nombre: document.getElementById("name").value,
		    		apellido: document.getElementById("lastname").value,
		            email: document.getElementById("email").value,
		            contrasena: document.getElementById("passw").value,
		            edad: document.getElementById("age").value,
		            
		            id: document.getElementById("ced").value
		            
		            }
    	    
    	    
    	    
    	    let configs = {
    	            method: 'post',
    	            body: JSON.stringify(json),
    	            withCredentials: true,
    	            credentials: 'include',
    	            headers: {
    	                'Content-type': 'text'
    	            }
    	    }
    	    
    	    console.log(configs.body);
    	    fetch('./registro', configs)
    	        .then(res => res.json())
    	        .then(data => {
    	        	console.log(data)
    	        	let userData = data.userData;
    	            if(data.status == 200){
    	            	alert("todo bien registro con exito");
    	            	document.location.replace(`http://localhost:9092/Servidor/home.html`)
    	            }
    	            	else{
    	            		console.log("jaja kloko no");
    	            	}
    	            	
    	    });
    	}
    }


function checkEmail() {
    var email = document.getElementById('email');
    var mailFormat = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;

    if (!mailFormat.test(email.value)) {
        alert('Direccion de correo invalida');
        email.focus;
        return false;
    }else{
    	a = 1;
    }
}


const check = () => {
	checkEmail();
	checkPassword();
	registrar();
	
}
function checkPassword(){
    var password = document.getElementById('passw');
    var passwordFormat= /(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/;

    if (!passwordFormat.test(password.value)) {
        alert('La contrasena debe tener al menos un numero, una letra mayuscula y una letra minuscula con minimo 6');
        password.focus;
        return false;
        console.log(aa);
    }else{
    	b = 1;
    }
}
</script>
  </body>
</html>